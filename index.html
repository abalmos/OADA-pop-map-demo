<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <title>OADA Pop-Map Demo</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <!-- leaflet includes -->
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
  <!-- styling - put in another file later -->
  <style>
    body {margin: 0; padding: 0;}
    #map {width:100%; height:260px;}
    #jsx {width:100%; height:25%;}
    #dom {width:100%; height:25%;}
  </style>
</head>
<body>
  <!-- react.js includes -->
  <script src="http://fb.me/react-0.11.1.js"></script>
  <script src="http://fb.me/JSXTransformer-0.11.1.js"></script>
  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

    <div id='jsx'></div>
    <div id='dom'></div>
    <div id='map'></div>
<!-- old map - remove
  <script>
    L.mapbox.accessToken = 'pk.eyJ1IjoibmFwa2luc3RlcnJvciIsImEiOiJZdUhPX0ljIn0.wUA8FDY5uJBKmDleHby0wQ';
    var map = L.mapbox.map('map', 'mapbox.streets')
    .setView([40, -74.50], 9);
  </script>
  old map -->

<script type="text/jsx">
    /** @jsx React.DOM */
    
    var Map = React.createClass({
      componentDidMount: function() {
        var map = this.mapp = L.map(this.getDOMNode(), {
          minZoom: 2,
          maxZoom: 20,
          layers: [
            L.titleLayer(
                'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
                { attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA </a>'
              })
          ],
          attributionControl: false,
        });

        map.on('click', this.onMapClick);
        map.fitWorld();
        console.log('mounted');
      },

      componentWillUnmount: function() {
        this.map.off('click', this.onMapClick);
        this.map = null;
        console.log('unmounted');
      },

      onMapClick: function() {
        // see where a user click and see if its in a prescription area
        // - highlet affects and edit value in that prescription area
        console.log('clicked')
      },

      render: function() {
        return ( 
            <div className="map">             
            </div>
          );
      }
    });
    
    var MessageBoxJSX = React.createClass({
      render: function() {
        return (
          <div className="container">
            <h1>Hello, World! From JSX</h1>
            <SubMessage />
          </div>
        );
      }
    });

    var MessageBoxDOM = React.createClass({
      render: function() {
        return React.DOM.div({
           className: 'container'},
           React.DOM.h1(null, 'Hello, World! From DOM'),
           SubMessage(null)
           );
      }
    });
    
    var SubMessage = React.createClass({
      render: function() {
        return (
          <small> Its good to see you </small>
        );
      }
    });
    
    var reactComponentMap = React.renderComponent(
      <Map />,
      document.getElementById('map'),
      function() {
        console.log('map react component callback');
      });

    
    var reactComponentJSX = React.renderComponent(
      <MessageBoxJSX/>,
      document.getElementById('jsx'),
      function() {
        console.log('callback');
      });

    var reactComponentDOM = React.renderComponent(
      MessageBoxDOM(null),
      document.getElementById('dom')
      );

  </script>


</body>
</html>

